function status = Animate_real_time_1D_new(t,u,flag)
% Animate robot response in real time 

    global m;
    global l;
    global r;
    global r2;
    global g;
    global k;
    global lambda;
    
    global Kp1;
    global Ki1;
    global Kd1;
    global Kp2;
    global Ki2;
    global Kd2;
    
    
    
    global r_target;
    global t_target;
    global x_target;
    global y_target;
    global r_actual_list;
    global r_target_list;
    global t_actual_list;
    global t_target_list;
    global time_list;
    
    global f1_list;
    global f2_list;
    global ff1_list;
    global ff2_list;
    
    global f1t_list;
    global f2t_list;
    global ff1t_list;
    global ff2t_list;
    
    global f1r_list;
    global f2r_list;
    global ff1r_list;
    global ff2r_list;
    
    global P_list;
    global I_list;
    global D_list;
    
    x_actual = @(u) -l*(2*sin(u(1))+2*sin(u(1)+u(3))+2*sin(u(1)+u(3)+u(5))+2*sin(u(1)+u(3)+u(5)+u(7))+2*sin(u(1)+u(3)+u(5)+u(7)+u(9))+2*sin(u(1)+u(3)+u(5)+u(7)+u(9)+u(11))+2*sin(u(1)+u(3)+u(5)+u(7)+u(9)+u(11)+u(13))+sin(u(1)+u(3)+u(5)+u(7)+u(9)+u(11)+u(13)+u(15))) ;      
    y_actual = @(u) l*(1+2*cos(u(1))+2*cos(u(1)+u(3))+2*cos(u(1)+u(3)+u(5))+2*cos(u(1)+u(3)+u(5)+u(7))+2*cos(u(1)+u(3)+u(5)+u(7)+u(9))+2*cos(u(1)+u(3)+u(5)+u(7)+u(9)+u(11))+2*cos(u(1)+u(3)+u(5)+u(7)+u(9)+u(11)+u(13))+cos(u(1)+u(3)+u(5)+u(7)+u(9)+u(11)+u(13)+u(15)) );

    status = 0;

    if size(u,2) > 0
        for i =1:size(u,2)
            figure(1)
            
            cla
            load('workspace 1d x,y.mat', 'temp_x','temp_y');
            plot(temp_x,temp_y,'.');
            hold on;
            plot(-temp_x,temp_y,'.');
            hold on;
            x_target = -r_target*sin(t_target/180*pi);
            y_target = r_target*cos(t_target/180*pi);
            plot(x_target,y_target, 'b*');%, 'MarkerSize', 12);


            u_rel = u(:,i);

            u0(1) = -u_rel(1);
            u0(3) = -u_rel(1) - u_rel(3);
            u0(5) = -u_rel(1) - u_rel(3) -u_rel(5);
            u0(7) = -u_rel(1) - u_rel(3) -u_rel(5) - u_rel(7);
            u0(9) = -u_rel(1) - u_rel(3) -u_rel(5) - u_rel(7) - u_rel(9);
            u0(11) = -u_rel(1) - u_rel(3) -u_rel(5) - u_rel(7) - u_rel(9) - u_rel(11);
            u0(13) = -u_rel(1) - u_rel(3) -u_rel(5) - u_rel(7) - u_rel(9) - u_rel(11) - u_rel(13);
            u0(15) = -u_rel(1) - u_rel(3) -u_rel(5) - u_rel(7) - u_rel(9) - u_rel(11) - u_rel(13) - u_rel(15);

            %h=0.025;
            %w=0.1;
            x1=0;
            y1=l;
            x2=2*l*sin(u0(1));
            y2=2*l*cos(u0(1));
            x3=2*l*sin(u0(3));
            y3=2*l*cos(u0(3));
            x4=2*l*sin(u0(5));
            y4=2*l*cos(u0(5));
            x5=2*l*sin(u0(7));
            y5=2*l*cos(u0(7));
            x6=2*l*sin(u0(9));
            y6=2*l*cos(u0(9));
            x7=2*l*sin(u0(11));
            y7=2*l*cos(u0(11));
            x8=2*l*sin(u0(13));
            y8=2*l*cos(u0(13));
            x9=l*sin(u0(15));
            y9=l*cos(u0(15));

            dx1 = l*sin(u0(1)) - r*cos(u0(1));
            dy1 = l + l*cos(u0(1)) + r*sin(u0(1));
            dx2 =     2*l*sin(u0(1)) + l*sin(u0(3)) - r*cos(u0(3));
            dy2 = l + 2*l*cos(u0(1)) + l*cos(u0(3)) + r*sin(u0(3));
            dx3 =     2*l*sin(u0(1)) + 2*l*sin(u0(3)) + l*sin(u0(5)) - r*cos(u0(5));
            dy3 = l + 2*l*cos(u0(1)) + 2*l*cos(u0(3)) + l*cos(u0(5)) + r*sin(u0(5));
            dx4 =     2*l*sin(u0(1)) + 2*l*sin(u0(3)) + 2*l*sin(u0(5)) + l*sin(u0(7)) - r*cos(u0(7));
            dy4 = l + 2*l*cos(u0(1)) + 2*l*cos(u0(3)) + 2*l*cos(u0(5)) + l*cos(u0(7)) + r*sin(u0(7));
            dx5 =     2*l*sin(u0(1)) + 2*l*sin(u0(3)) + 2*l*sin(u0(5)) + 2*l*sin(u0(7)) + l*sin(u0(9)) - r*cos(u0(9));
            dy5 = l + 2*l*cos(u0(1)) + 2*l*cos(u0(3)) + 2*l*cos(u0(5)) + 2*l*cos(u0(7)) + l*cos(u0(9)) + r*sin(u0(9));
            dx6 =     2*l*sin(u0(1)) + 2*l*sin(u0(3)) + 2*l*sin(u0(5)) + 2*l*sin(u0(7)) + 2*l*sin(u0(9)) + l*sin(u0(11)) - r*cos(u0(11));
            dy6 = l + 2*l*cos(u0(1)) + 2*l*cos(u0(3)) + 2*l*cos(u0(5)) + 2*l*cos(u0(7)) + 2*l*cos(u0(9)) + l*cos(u0(11)) + r*sin(u0(11));
            dx7 =     2*l*sin(u0(1)) + 2*l*sin(u0(3)) + 2*l*sin(u0(5)) + 2*l*sin(u0(7)) + 2*l*sin(u0(9)) + 2*l*sin(u0(11)) + l*sin(u0(13)) - r*cos(u0(13));
            dy7 = l + 2*l*cos(u0(1)) + 2*l*cos(u0(3)) + 2*l*cos(u0(5)) + 2*l*cos(u0(7)) + 2*l*cos(u0(9)) + 2*l*cos(u0(11)) + l*cos(u0(13))  + r*sin(u0(13));
            dx8 =     2*l*sin(u0(1)) + 2*l*sin(u0(3)) + 2*l*sin(u0(5)) + 2*l*sin(u0(7)) + 2*l*sin(u0(9)) + 2*l*sin(u0(11)) + 2*l*sin(u0(13)) + l*sin(u0(15)) - r*cos(u0(15));
            dy8 = l + 2*l*cos(u0(1)) + 2*l*cos(u0(3)) + 2*l*cos(u0(5)) + 2*l*cos(u0(7)) + 2*l*cos(u0(9)) + 2*l*cos(u0(11)) + 2*l*cos(u0(13)) + l*cos(u0(15)) + r*sin(u0(15));

            %cart=rectangle('Position',[u0(1)-w/2  0  w h ],'LineWidth',2);
            base_h = plot([x1-r x1+r],[0 0],'k','LineWidth',2);
            base_v = plot([x1 x1],[0 y1],'k','LineWidth',2);
            pole1=plot([x1 x1+x2],[y1 y1+y2],'k','LineWidth',2);
            pole2=plot([x1+x2 x1+x2+x3],[y1+y2 y1+y2+y3],'k','LineWidth',2);
            pole3=plot([x1+x2+x3 x1+x2+x3+x4],[y1+y2+y3 y1+y2+y3+y4],'k','LineWidth',2);
            pole4=plot([x1+x2+x3+x4 x1+x2+x3+x4+x5],[y1+y2+y3+y4 y1+y2+y3+y4+y5],'k','LineWidth',2);
            pole5=plot([x1+x2+x3+x4+x5 x1+x2+x3+x4+x5+x6],[y1+y2+y3+y4+y5 y1+y2+y3+y4+y5+y6],'k','LineWidth',2);
            pole6=plot([x1+x2+x3+x4+x5+x6 x1+x2+x3+x4+x5+x6+x7],[y1+y2+y3+y4+y5+y6 y1+y2+y3+y4+y5+y6+y7],'k','LineWidth',2);
            pole7=plot([x1+x2+x3+x4+x5+x6+x7 x1+x2+x3+x4+x5+x6+x7+x8],[y1+y2+y3+y4+y5+y6+y7 y1+y2+y3+y4+y5+y6+y7+y8],'k','LineWidth',2);
            pole8=plot([x1+x2+x3+x4+x5+x6+x7+x8 x1+x2+x3+x4+x5+x6+x7+x8+x9],[y1+y2+y3+y4+y5+y6+y7+y8 y1+y2+y3+y4+y5+y6+y7+y8+y9],'k','LineWidth',2);

            radius = 50;
            mass1=scatter(x1+x2/2                       ,y1+y2/2                        ,radius,'k','filled');
            mass2=scatter(x1+x2+x3/2                    ,y1+y2+y3/2                     ,radius,'k','filled');
            mass3=scatter(x1+x2+x3+x4/2                 ,y1+y2+y3+y4/2                  ,radius,'k','filled');
            mass4=scatter(x1+x2+x3+x4+x5/2              ,y1+y2+y3+y4+y5/2               ,radius,'k','filled');
            mass5=scatter(x1+x2+x3+x4+x5+x6/2           ,y1+y2+y3+y4+y5+y6/2            ,radius,'k','filled');
            mass6=scatter(x1+x2+x3+x4+x5+x6+x7/2        ,y1+y2+y3+y4+y5+y6+y7/2         ,radius,'k','filled');
            mass7=scatter(x1+x2+x3+x4+x5+x6+x7+x8/2     ,y1+y2+y3+y4+y5+y6+y7+y8/2      ,radius,'k','filled');
            mass8=scatter(x1+x2+x3+x4+x5+x6+x7+x8+x9    ,y1+y2+y3+y4+y5+y6+y7+y8+y9     ,radius,'k','filled');

            disk1 = plot([dx1 dx1+2*r*cos(u0(1))],[dy1 dy1-2*r*sin(u0(1))],'k','LineWidth',2);
            disk2 = plot([dx2 dx2+2*r*cos(u0(3))],[dy2 dy2-2*r*sin(u0(3))],'k','LineWidth',2);
            disk3 = plot([dx3 dx3+2*r*cos(u0(5))],[dy3 dy3-2*r*sin(u0(5))],'k','LineWidth',2);
            disk4 = plot([dx4 dx4+2*r*cos(u0(7))],[dy4 dy4-2*r*sin(u0(7))],'k','LineWidth',2);
            disk5 = plot([dx5 dx5+2*r*cos(u0(9))],[dy5 dy5-2*r*sin(u0(9))],'k','LineWidth',2);
            disk6 = plot([dx6 dx6+2*r*cos(u0(11))],[dy6 dy6-2*r*sin(u0(11))],'k','LineWidth',2);
            disk7 = plot([dx7 dx7+2*r*cos(u0(13))],[dy7 dy7-2*r*sin(u0(13))],'k','LineWidth',2);
            disk8 = plot([dx8 dx8+2*r*cos(u0(15))],[dy8 dy8-2*r*sin(u0(15))],'k','LineWidth',2);

            drawnow
            

            time_list(end+1) = t(i);
            r_actual = (x_actual(u(:,i))^2 + y_actual(u(:,i))^2)^0.5;
            r_actual_list(end+1) = r_actual;
            r_target_list(end+1) = r_target;
            t_actual = atan(-x_actual(u(:,i))/y_actual(u(:,i)))*180/pi;
            t_actual_list(end+1) = t_actual;
            t_target_list(end+1) = t_target;    
            
            figure(4)
            cla

            subplot(3,1,1)
            cla
            plot(time_list,t_actual_list,'k')
            hold on;
            plot(time_list,t_target_list,'r')
            hold off;
            xlabel('$Time$ $(s)$','Interpreter','latex','FontSize', 12)
            ylabel('$\theta_{EE}$ $(^{\circ})$','Interpreter','latex','FontSize', 12)
            grid on;
            
            errort = u(17,i);
            errorr = u(18,i);
            dot_r_actual = @(u) (u(2)*(2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1))) - 2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2)) - (u(12)*(2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) - 2*l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2)) - (u(10)*(2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) - 2*l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2)) - (u(14)*(2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) - 2*l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2)) - (u(8)*(2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) - 2*l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2)) - (u(6)*(2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) - 2*l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2)) - (u(16)*(2*l^2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) - 2*l^2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2)) - (u(4)*(2*l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)))*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) - 2*l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))))/(2*(l^2*(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + l^2*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2)^(1/2));
            dot_t_actual = @(u) (180*u(6)*((2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) + ((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1))))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1)) - (180*u(2)*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + (2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1)) - (180*u(16)*(cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) + (sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1))))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1)) - (180*u(4)*((2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) + ((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1))))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1)) - (180*u(12)*((2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) + ((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1))))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1)) - (180*u(10)*((2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) + ((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1))))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1)) - (180*u(14)*((2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) + ((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1))))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1)) - (180*u(8)*((2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1) + ((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)))*(2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1))))/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2))/(pi*((2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*sin(u(1) + u(3) + u(5)) + sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*sin(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*sin(u(1) + u(3) + u(5) + u(7)) + 2*sin(u(1) + u(3)) + 2*sin(u(1)))^2/(2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9)) + 2*cos(u(1) + u(3) + u(5)) + cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11) + u(13) + u(15)) + 2*cos(u(1) + u(3) + u(5) + u(7) + u(9) + u(11)) + 2*cos(u(1) + u(3) + u(5) + u(7)) + 2*cos(u(1) + u(3)) + 2*cos(u(1)) + 1)^2 + 1));


            P = (t_target-t_actual)*Kp1;
            I = errort*Ki1;
            D = dot_t_actual(u(:,i))*Kd1;
            
            f1t = P + I + D;
            ff1t = 0;
            f2t = -P - I - D;
            ff2t = 0;
            

            disp(errort);
            
            threshold = 10000;
            min_thres = 0;
            f1 = min(max(f1t, min_thres), threshold);
            f2 = min(max(f2t, min_thres), threshold); 
            ff1 = 0;
            ff2 = 0;
            
            P_list(end+1) = P;
            I_list(end+1) = I;
            D_list(end+1) = D;
            
            f1_list(end+1) = f1;
            f2_list(end+1) = f2;
            ff1_list(end+1) = ff1;
            ff2_list(end+1) = ff2;

    
            subplot(3,1,2)
            cla
            plot(time_list,f1_list,'k')

            xlabel('$Time$ $(s)$','Interpreter','latex','FontSize', 12)
            ylabel('$f_{l,1}$ $(N)$','Interpreter','latex','FontSize', 12)
            grid on;
            
            subplot(3,1,3)
            cla
            plot(time_list,f2_list,'k')
            xlabel('$Time$ $(s)$','Interpreter','latex','FontSize', 12)
            ylabel('$f_{l,2}$ $(N)$','Interpreter','latex','FontSize', 12)
            grid on;
        end
    end
end